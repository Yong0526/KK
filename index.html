<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>è½»æ¾å°æ¸¸æˆ â€” ä¸‰å…³</title>
<style>
:root {
  --bg:#f5f0e6;--card-face:#fff;--card-back:#e8dbc7;--accent:#c9a86b;
  --text:#3b3b3b;--shadow:rgba(31,31,31,0.12);--card-size:80px;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{min-height:100vh;display:flex;flex-direction:column;font-family:system-ui;background:var(--bg);color:var(--text);}
header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:rgba(255,255,255,0.7);box-shadow:0 2px 6px var(--shadow);position:sticky;top:0;z-index:10;}
h1{font-size:18px;font-weight:700;}
.meta{display:flex;gap:10px;font-size:14px;}
.container{flex:1;display:flex;flex-direction:column;align-items:center;padding:12px;overflow-y:auto;}
.board-wrap{background:rgba(255,255,255,0.55);padding:12px;border-radius:12px;box-shadow:0 6px 12px var(--shadow);margin-top:12px;width:100%;max-width:480px;}
.board{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;justify-items:center;}
.card{width:var(--card-size);height:var(--card-size);perspective:1000px;touch-action:manipulation;}
.card-inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform 0.42s cubic-bezier(.2,.9,.3,1);}
.card.flipped .card-inner{transform:rotateY(180deg);}
.card-face,.card-back{position:absolute;inset:0;border-radius:8px;display:flex;align-items:center;justify-content:center;backface-visibility:hidden;box-shadow:0 4px 12px var(--shadow);font-size:24px;}
.card-back{background:var(--card-back);}
.card-face{background:var(--card-face);transform:rotateY(180deg);}
button{background:var(--accent);border:none;padding:12px 16px;border-radius:10px;color:white;font-weight:600;font-size:16px;cursor:pointer;margin:6px 4px;}
button:hover{opacity:0.9;}
button.secondary{background:transparent;color:var(--text);border:1px solid rgba(0,0,0,0.1);}
.overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(245,240,230,0.95);backdrop-filter:blur(3px);z-index:20;}
.panel{background:var(--card-face);padding:24px;border-radius:14px;box-shadow:0 16px 32px var(--shadow);max-width:90%;text-align:center;}
.footer{padding:10px;font-size:13px;text-align:center;color:#6b5b3b;}
.category-wrap{display:flex;justify-content:space-around;margin-top:12px;flex-wrap:wrap;}
.category{background:var(--card-back);border-radius:12px;padding:12px;width:120px;min-height:120px;display:flex;align-items:center;justify-content:center;flex-direction:column;box-shadow:0 4px 10px var(--shadow);}
.item{background:var(--card-face);padding:10px;margin:6px;border-radius:8px;cursor:grab;touch-action:manipulation;box-shadow:0 2px 6px var(--shadow);}
@media(max-width:400px){:root{--card-size:60px;}.board{grid-template-columns:repeat(3,1fr);}}
</style>
</head>
<body>
<header>
  <h1>è½»æ¾å°æ¸¸æˆ â€” ä¸‰å…³</h1>
  <div class="meta">
    <div id="moves">æ­¥æ•°:0</div>
    <div id="time">æ—¶é—´:00:00</div>
  </div>
</header>

<div class="container">
  <!-- ç¬¬ä¸€å…³ -->
  <div class="board-wrap" id="level1Wrap">
    <h2 style="text-align:center;">ç¬¬ä¸€å…³ï¼šç¿»ç‰Œæ¸¸æˆï¼ˆ8å¯¹ï¼‰</h2>
    <div class="board" id="board"></div>
    <div style="text-align:center;margin-top:8px;">
      <button id="startBtn">å¼€å§‹æ¸¸æˆ</button>
      <button id="restartBtn" class="secondary">é‡ç½®</button>
    </div>
  </div>

  <!-- ç¬¬äºŒå…³ -->
  <div class="board-wrap" id="level2Wrap" style="display:none;">
    <h2 style="text-align:center;">ç¬¬äºŒå…³ï¼šç‰©å“å½’ç±»ï¼ˆ3ç±»ï¼‰</h2>
    <div class="category-wrap">
      <div class="category" data-name="æ°´æœ">æ°´æœ</div>
      <div class="category" data-name="æ˜Ÿæ˜Ÿ">æ˜Ÿæ˜Ÿ</div>
      <div class="category" data-name="éŸ³ä¹">éŸ³ä¹</div>
    </div>
    <div style="display:flex;justify-content:center;flex-wrap:wrap;margin-top:12px;">
      <div class="item" draggable="true" data-type="æ°´æœ">ğŸ’</div>
      <div class="item" draggable="true" data-type="æ°´æœ">ğŸ</div>
      <div class="item" draggable="true" data-type="æ˜Ÿæ˜Ÿ">â­</div>
      <div class="item" draggable="true" data-type="æ˜Ÿæ˜Ÿ">ğŸŒŸ</div>
      <div class="item" draggable="true" data-type="éŸ³ä¹">ğŸµ</div>
      <div class="item" draggable="true" data-type="éŸ³ä¹">ğŸ¶</div>
    </div>
    <div style="text-align:center;margin-top:8px;">
      <button id="toLevel3Btn" class="secondary" style="display:none;">ä¸‹ä¸€å…³</button>
    </div>
  </div>

  <div class="footer">æç¤ºï¼šå®Œæˆæ‰€æœ‰å…³å¡å³å¯ç»“æŸæ¸¸æˆã€‚</div>
</div>

<div class="overlay" id="startOverlay">
  <div class="panel">
    <h2>ç±³è‰²å°æ¸¸æˆ â€” ç¬¬ä¸€å…³</h2>
    <p>å‡†å¤‡å¥½äº†å—ï¼Ÿç‚¹å‡»ã€Œå¼€å§‹æ¸¸æˆã€åï¼Œè®¡æ—¶ä¸æ­¥æ•°å°†å¼€å¯ã€‚</p>
    <button id="overlayStart">å¼€å§‹æ¸¸æˆ</button>
  </div>
</div>

<script>
// ---------- ç¬¬ä¸€å…³ç¿»ç‰Œ ----------
const boardEl = document.getElementById('board');
const movesEl = document.getElementById('moves');
const timeEl = document.getElementById('time');
const startBtn = document.getElementById('startBtn');
const restartBtn = document.getElementById('restartBtn');
const overlay = document.getElementById('startOverlay');
const overlayStart = document.getElementById('overlayStart');

let symbols=['ğŸ’','ğŸŒ¿','â­','ğŸµ','ğŸŒ¸','ğŸ‡','ğŸ‰','ğŸ'],deck=[],firstCard=null,secondCard=null;
let lock=false,moves=0,matched=0,timerInterval=null,seconds=0,started=false;

function formatTime(s){return `${String(Math.floor(s/60)).padStart(2,'0')}:${String(s%60).padStart(2,'0')}`;}
function buildDeck(){deck=symbols.concat(symbols).map((s,i)=>({id:i,sym:s}));for(let i=deck.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[deck[i],deck[j]]=[deck[j],deck[i]];}}
function renderBoard(){boardEl.innerHTML='';deck.forEach(card=>{const c=document.createElement('div');c.className='card';c.innerHTML=`<div class="card-inner"><div class="card-back"></div><div class="card-face">${card.sym}</div></div>`;c.addEventListener('click',()=>onCardClick(c,card));boardEl.appendChild(c);});}
function startTimer(){if(timerInterval)clearInterval(timerInterval);seconds=0;timeEl.textContent='æ—¶é—´:00:00';timerInterval=setInterval(()=>{seconds++;timeEl.textContent='æ—¶é—´:'+formatTime(seconds)},1000);}
function stopTimer(){if(timerInterval)clearInterval(timerInterval);}
function onCardClick(el,card){
  if(lock||el.classList.contains('flipped'))return;
  if(!started){started=true;startTimer();}
  el.classList.add('flipped');
  if(!firstCard){firstCard={el,card};return;}
  if(!secondCard){secondCard={el,card};}
  moves++;movesEl.textContent='æ­¥æ•°:'+moves;
  lock=true;
  if(firstCard.card.sym===secondCard.card.sym){
    setTimeout(()=>{
      firstCard.el.style.visibility='hidden';
      secondCard.el.style.visibility='hidden';
      matched+=2;
      resetSelection();
      if(matched===deck.length){stopTimer();setTimeout(showLevel2Panel,400);}
    },420);
  }else{setTimeout(()=>{firstCard.el.classList.remove('flipped');secondCard.el.classList.remove('flipped');resetSelection();},900);}
}
function resetSelection(){firstCard=null;secondCard=null;lock=false;}
function showLevel2Panel(){
  const panel=document.createElement('div');panel.className='overlay';
  panel.innerHTML=`<div class="panel"><h2>æ­å–œå®Œæˆç¬¬ä¸€å…³ ğŸ‰</h2><p>ç”¨æ—¶ ${formatTime(seconds)} æ­¥æ•° ${moves}</p><button id="nextLevelBtn">ä¸‹ä¸€å…³</button></div>`;
  document.body.appendChild(panel);
  document.getElementById('nextLevelBtn').addEventListener('click',()=>{
    panel.remove();
    document.getElementById('level1Wrap').style.display='none';
    document.getElementById('level2Wrap').style.display='block';
  });
}
function resetGame(){stopTimer();started=false;moves=0;matched=0;movesEl.textContent='æ­¥æ•°:0';timeEl.textContent='æ—¶é—´:00:00';buildDeck();renderBoard();}

startBtn.addEventListener('click',()=>{overlay.style.display='flex';overlayStart.focus();});
overlayStart.addEventListener('click',()=>{overlay.style.display='none';resetGame();});
restartBtn.addEventListener('click',()=>{resetGame();});

buildDeck();renderBoard();

// ---------- ç¬¬äºŒå…³æ‹–æ”¾é€»è¾‘ ----------
const items = document.querySelectorAll('.item');
const categories = document.querySelectorAll('.category');
items.forEach(item=>{
  item.addEventListener('dragstart', e=>{e.dataTransfer.setData('type', item.dataset.type);});
});
categories.forEach(cat=>{
  cat.addEventListener('dragover', e=>e.preventDefault());
  cat.addEventListener('drop', e=>{
    e.preventDefault();
    const type = e.dataTransfer.getData('type');
    if(type===cat.dataset.name){
      const dragged = [...items].find(i=>i.dataset.type===type && i.parentElement!==cat);
      if(dragged){cat.appendChild(dragged);}
      checkLevel2Complete();
    }
  });
});
const toLevel3Btn = document.getElementById('toLevel3Btn');
function checkLevel2Complete(){
  const allPlaced = [...items].every(item=>item.parentElement.dataset.name===item.dataset.type);
  if(allPlaced){
    toLevel3Btn.style.display='inline-block';
  }
}
toLevel3Btn.addEventListener('click',()=>{
  // ç›´æ¥è·³è½¬åˆ° kk2.html
  window.location.href = 'kk2.html';
});
</script>
</body>
</html>


