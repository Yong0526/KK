<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>ç¬¬ä¸‰å…³ï¼šå¨æˆ¿æ•´ç†ï¼ˆç‚¹å‡»ç‰ˆç›´æ¥è·³è½¬ï¼‰</title>
<style>
:root {
  --bg:#f5f0e6;--card-face:#fff;--accent:#c9a86b;
  --text:#3b3b3b;--shadow:rgba(31,31,31,0.12);--item-size:80px;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{min-height:100vh;display:flex;flex-direction:column;font-family:system-ui;background:var(--bg);color:var(--text);}
header{display:flex;justify-content:center;align-items:center;padding:12px;background:rgba(255,255,255,0.7);box-shadow:0 2px 6px var(--shadow);position:sticky;top:0;z-index:10;}
h1{font-size:18px;font-weight:700;text-align:center;}
.container{flex:1;display:flex;flex-direction:column;align-items:center;padding:12px;overflow-y:auto;}
.board-wrap{background:rgba(255,255,255,0.55);padding:12px;border-radius:12px;box-shadow:0 6px 12px var(--shadow);margin-top:12px;width:100%;max-width:480px;}
.category{background:var(--card-face);border-radius:12px;padding:12px;margin:8px 0;width:100%;min-height:120px;display:flex;flex-wrap:wrap;align-items:flex-start;justify-content:flex-start;gap:8px;box-shadow:0 4px 10px var(--shadow);transition:0.3s;}
.category-title{text-align:center;width:100%;margin-bottom:8px;font-weight:600;color:var(--text);}
.item{background:var(--accent);color:white;font-size:32px;padding:10px;border-radius:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex:0 0 var(--item-size);height:var(--item-size);box-shadow:0 2px 6px var(--shadow);transition:transform 0.2s;}
.item:active{transform:scale(1.1);}
.status{text-align:center;margin:6px 0;font-size:16px;}
button{background:var(--accent);border:none;padding:10px 14px;border-radius:10px;color:white;font-weight:600;font-size:16px;cursor:pointer;margin:6px 4px;}
button:hover{opacity:0.9;}
.flash{animation:flashBG 0.5s;}
@keyframes flashBG{0%{background-color:#f00;}50%{background-color:#f5f0e6;}100%{background-color:#f00;}}
</style>
</head>
<body>
<header><h1>ç¬¬ä¸‰å…³ï¼šå¨æˆ¿æ•´ç†ï¼ˆç‚¹å‡»ç‰ˆç›´æ¥è·³è½¬ï¼‰</h1></header>

<div class="container">
  <div class="board-wrap">
    <p style="text-align:center;">ç‚¹å‡»é¤å…·ï¼Œå°†å…¶ä¾æ¬¡æ”¾å…¥æ°´æ§½æ´—å¹²å‡€ï¼Œå†ç‚¹å‡»æ”¾å…¥é¤æ¶ï¼</p>

    <div class="category" id="dirtyArea">
      <div class="category-title">è„ç¢—ç¢ŸåŒº</div>
    </div>

    <div class="category" id="sink">
      <div class="category-title">æ°´æ§½ï¼ˆæœ€å¤š3ä¸ªï¼‰</div>
    </div>

    <div class="category" id="rack">
      <div class="category-title">é¤æ¶</div>
    </div>

    <div class="status" id="washStatus">å·²æ´—: 0/0</div>
    <div class="status" id="sinkStatus">æ°´æ§½: 0/3</div>
    <div class="status" id="timer">å‰©ä½™æ—¶é—´: 60s</div>
    <div style="text-align:center;"><button id="restartBtn">é‡æ–°å¼€å§‹</button></div>
  </div>
</div>

<!-- éŸ³æ•ˆ -->
<audio id="washSound" src="https://cdn.jsdelivr.net/gh/YongLing/static-assets/wash.mp3"></audio>
<audio id="rackSound" src="https://cdn.jsdelivr.net/gh/YongLing/static-assets/rack.mp3"></audio>
<audio id="completeSound" src="https://cdn.jsdelivr.net/gh/YongLing/static-assets/complete.mp3"></audio>

<script>
const dirtyArea = document.getElementById('dirtyArea');
const sink = document.getElementById('sink');
const rack = document.getElementById('rack');
const washStatusEl = document.getElementById('washStatus');
const sinkStatusEl = document.getElementById('sinkStatus');
const timerEl = document.getElementById('timer');

const washSound = document.getElementById('washSound');
const rackSound = document.getElementById('rackSound');
const completeSound = document.getElementById('completeSound');

const allTypes = ['ç›˜å­','ç¢—','æ¯å­','å‹ºå­','åˆ€å‰'];
const typeEmoji = {'ç›˜å­':'ğŸ½ï¸','ç¢—':'ğŸ¥£','æ¯å­':'ğŸ¥›','å‹ºå­':'ğŸ¥„','åˆ€å‰':'ğŸ´'};
const sinkCapacity = 3;

function initItems(){
  dirtyArea.innerHTML='<div class="category-title">è„ç¢—ç¢ŸåŒº</div>';
  allTypes.forEach(type=>{
    const count = Math.floor(Math.random()*2)+2;
    for(let i=0;i<count;i++){
      const item = document.createElement('div');
      item.className='item';
      item.dataset.type=type;
      item.dataset.state='dirty';
      item.textContent = typeEmoji[type];
      dirtyArea.appendChild(item);
    }
  });
}

let kitchenItems, washedCount=0, sinkCount=0, totalToWash=0;

function updateStatus(){
  washStatusEl.textContent = `å·²æ´—: ${washedCount}/${totalToWash}`;
  sinkStatusEl.textContent = `æ°´æ§½: ${sinkCount}/${sinkCapacity}`;
}

function itemClickHandler(e){
  const item = e.currentTarget;
  if(item.dataset.state==='dirty'){
    if(sinkCount >= sinkCapacity){
      sink.classList.add('flash');
      setTimeout(()=>sink.classList.remove('flash'),500);
      return;
    }
    sink.appendChild(item);
    item.dataset.state='sink';
    sinkCount++;
    washedCount++;
    washSound.currentTime=0; washSound.play();
  } else if(item.dataset.state==='sink'){
    rack.appendChild(item);
    item.dataset.state='rack';
    sinkCount--;
    rackSound.currentTime=0; rackSound.play();
    checkComplete();
  }
  updateStatus();
}

function attachClick(){
  kitchenItems = document.querySelectorAll('.item');
  totalToWash = kitchenItems.length;
  kitchenItems.forEach(item=>item.onclick = itemClickHandler);
  updateStatus();
}

// æ£€æŸ¥æ˜¯å¦å®Œæˆï¼Œç›´æ¥è·³è½¬
function checkComplete(){
  const placed = [...rack.querySelectorAll('.item')];
  if(placed.length === totalToWash){
    clearInterval(timerInterval);
    completeSound.play();
    setTimeout(()=>{ window.location.href='kk3.html'; },500);
  }
}

let timeLeft=60;
timerEl.textContent=`å‰©ä½™æ—¶é—´: ${timeLeft}s`;
const timerInterval=setInterval(()=>{
  timeLeft--;
  timerEl.textContent=`å‰©ä½™æ—¶é—´: ${timeLeft}s`;
  if(timeLeft<=0){
    clearInterval(timerInterval);
    alert('æ—¶é—´åˆ°ï¼æŒ‘æˆ˜å¤±è´¥ â°');
    window.location.reload();
  }
},1000);

function startGame(){
  washedCount=0; sinkCount=0; timeLeft=60;
  updateStatus();
  initItems();
  attachClick();
}

startGame();
document.getElementById('restartBtn').addEventListener('click', startGame);
</script>
</body>
</html>

